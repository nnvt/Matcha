"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),r=require("@babel/runtime/helpers/objectWithoutPropertiesLoose"),t=require("react"),a=require("react-three-fiber"),n=require("three"),i=require("three/examples/jsm/shaders/HorizontalBlurShader"),u=require("three/examples/jsm/shaders/VerticalBlurShader");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=o(e),s=o(r),d=t.forwardRef((function(e,r){var o=e.opacity,d=void 0===o?1:o,h=e.width,f=void 0===h?1:h,c=e.height,m=void 0===c?1:c,p=e.blur,g=void 0===p?1:p,v=e.far,b=void 0===v?10:v,M=e.resolution,w=void 0===M?256:M,x=s.default(e,["opacity","width","height","blur","far","resolution"]),T=a.useThree(),S=T.scene,y=T.gl,R=t.useRef(),q=t.useMemo((function(){var e=new n.WebGLRenderTarget(w,w),r=new n.WebGLRenderTarget(w,w);r.texture.generateMipmaps=e.texture.generateMipmaps=!1;var t=new n.PlaneBufferGeometry(f,m).rotateX(Math.PI/2),a=new n.Mesh(t),o=new n.MeshDepthMaterial;o.depthTest=o.depthWrite=!1,o.onBeforeCompile=function(e){return e.fragmentShader=e.fragmentShader.replace("1.0 - fragCoordZ ), opacity );","0.0 ), ( 1.0 - fragCoordZ ) * 1.0 );")};var l=new n.ShaderMaterial(i.HorizontalBlurShader),s=new n.ShaderMaterial(u.VerticalBlurShader);return s.depthTest=l.depthTest=!1,[e,t,o,a,l,s,r]}),[w,f,m]),B=q[0],j=q[1],C=q[2],P=q[3],E=q[4],W=q[5],k=q[6];return a.useFrame((function(){if(R.current){var e=S.background;S.background=null,S.overrideMaterial=C,y.setRenderTarget(B),y.render(S,R.current),S.overrideMaterial=null,P.material=E,P.material.uniforms.tDiffuse.value=B.texture,E.uniforms.h.value=g/256,y.setRenderTarget(k),y.render(P,R.current),P.material=W,P.material.uniforms.tDiffuse.value=k.texture,W.uniforms.v.value=g/256,y.setRenderTarget(B),y.render(P,R.current),y.setRenderTarget(null),S.background=e}})),t.createElement("group",l.default({},x,{ref:r}),t.createElement("mesh",{geometry:j,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},t.createElement("meshBasicMaterial",{map:B.texture,transparent:!0,opacity:d})),t.createElement("orthographicCamera",{ref:R,args:[-f/2,f/2,m/2,-m/2,0,b]}))}));exports.ContactShadows=d;
