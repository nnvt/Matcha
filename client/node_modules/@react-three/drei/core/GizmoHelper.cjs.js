"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),require("@babel/runtime/helpers/extends"),require("@babel/runtime/helpers/objectWithoutPropertiesLoose");var e=require("react"),r=require("react-three-fiber");require("react-merge-refs");var t=require("three"),n=require("./OrthographicCamera.cjs.js"),o=require("./useCamera.cjs.js"),a=e.createContext({}),i=2*Math.PI,u=new t.Object3D,c=new t.Matrix4,s=new t.Quaternion,l=new t.Quaternion,p=new t.Vector3,m=new t.Vector3,h=new t.Quaternion;exports.GizmoHelper=function(d){var f=d.alignment,w=void 0===f?"bottom-right":f,g=d.margin,q=void 0===g?[80,80]:g,v=d.onUpdate,x=d.onTarget,y=d.children,b=r.useThree(),C=b.gl,j=b.camera,P=b.size,R=e.useRef(),T=e.useRef(null),M=e.useState((function(){return new t.Scene}))[0],O=e.useRef(!1),Q=e.useRef(0),S=e.useRef(new t.Vector3(0,0,0));r.useFrame((function(e,r){var t;T.current&&R.current&&(!function(e){if(O.current){var r=e*i;s.rotateTowards(l,r),j.position.set(0,0,1).applyQuaternion(s).multiplyScalar(Q.current).add(S.current),j.quaternion.rotateTowards(h,r),j.updateProjectionMatrix(),v&&v(),s.angleTo(l)<.01&&(O.current=!1)}}(r),c.copy(j.matrix).invert(),null==(t=R.current)||t.quaternion.setFromRotationMatrix(c),C.autoClear=!1,C.clearDepth(),C.render(M,T.current))}));var k={tweenCamera:function(e){O.current=!0,S.current=x(),Q.current=j.position.distanceTo(p),u.position.copy(p),u.lookAt(j.position),s.copy(u.quaternion),m.copy(e).multiplyScalar(Q.current).add(p),u.lookAt(m),l.copy(u.quaternion)},raycast:o.useCamera(T)},z=q[0],D=q[1],E=w.endsWith("-left")?-P.width/2+z:P.width/2-z,V=w.startsWith("top-")?P.height/2-D:-P.height/2+D;return r.createPortal(e.createElement(a.Provider,{value:k},e.createElement(n.OrthographicCamera,{ref:T,makeDefault:!1,position:[0,0,100]}),e.createElement("group",{ref:R,position:[E,V,0]},y)),M)},exports.useGizmoContext=function(){return e.useContext(a)};
